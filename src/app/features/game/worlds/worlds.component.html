<div class="galactic-map-container">
  <div class="corner-decoration corner-tl"></div>
  <div class="corner-decoration corner-tr"></div>
  <div class="corner-decoration corner-bl"></div>
  <div class="corner-decoration corner-br"></div>

  <div class="map-header">
    <h1 class="map-title">MAPA GAL√ÅCTICO</h1>
    <p class="map-subtitle">Escolha seu destino no cosmos</p>
  </div>

  <div class="star-map">
    <svg class="constellation-lines" viewBox="0 0 100 100" preserveAspectRatio="none">
      <path class="constellation-line" d="M15,30 L35,25 L50,40 L65,35" />
      <path class="constellation-line" d="M35,25 L40,50 L65,35" />
      <path class="constellation-line" d="M50,40 L55,60 L80,55" />
      <path class="constellation-line" d="M20,70 L40,50 L55,60" />
    </svg>

    <ng-container *ngFor="let world of worlds">
      <a *ngIf="world.status === 'open' && !isWorldCompleted(world.id) && characterId"
         class="galaxy-location"
         [routerLink]="['/game/battle', characterId, world.id]"
         [style.left]="world.position.left"
         [style.top]="world.position.top">
        <div class="galaxy-core">
          <div class="galaxy-spiral"></div>
          <div class="galaxy-center"></div>
        </div>
        <div class="galaxy-info">
          <div class="galaxy-name">{{ world.name }}</div>
          <div class="galaxy-description">{{ world.description }}</div>
          <div class="play-button">‚ñ∂ Jogar</div>
        </div>
      </a>

      <div *ngIf="world.status !== 'open' || isWorldCompleted(world.id)"
           class="galaxy-location"
           [ngClass]="{ 'completed': isWorldCompleted(world.id) || world.status === 'completed', 'locked': world.status === 'locked' }"
           [style.left]="world.position.left"
           [style.top]="world.position.top">
        <div class="galaxy-core">
          <div class="galaxy-spiral"></div>
          <div class="galaxy-center"></div>
        </div>
        <div class="galaxy-info">
          <div class="galaxy-name">{{ world.name }}</div>
          <div class="galaxy-description">{{ world.description }}</div>
          <div class="play-button" [ngClass]="{ 'completed-btn': isWorldCompleted(world.id) || world.status === 'completed', 'locked-btn': world.status === 'locked' }">
            <span *ngIf="isWorldCompleted(world.id) || world.status === 'completed'">‚úì Completo</span>
            <span *ngIf="world.status === 'locked'">üîí Bloqueado</span>
          </div>
        </div>
      </div>
    </ng-container>

    <div class="progress-indicator">
      <span class="progress-text">Progresso Total</span>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="calculateProgress()"></div>
      </div>
      <span class="progress-text">{{ calculateProgress() | number:'1.0-0' }}%</span>
    </div>
  </div>
</div>